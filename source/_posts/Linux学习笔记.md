---
title: Linux学习笔记
date: 2017-03-21 12:35:31
tags:
---

# Bash
<!--more-->

提示符:**$**,**#**.
**$**表示普通用户,**#**表示root用户

一般包含三部分内容:命令,选项,参数

如:firefox命令,打开firefox浏览器
而:firefox & 打开firefox浏览器并后台运行.

**tab**键的作用
在使用命令的时候,如键入u,然后连按2次tab,则会自动补全命令,如果命令有很多,则会显示
同样tab命令也可以补全参数名,比如文件名等.

**histroy**
histroy命令用于显示最近使用的命令

**ctrl + r**
该命令用于搜索最近使用的命令,只需要键入包含的任意字符串,就可以显示最近使用的命令

**su -**
切换为管理员权限

**touch**
创建一个空文件,或更新某一文件的时间

**cp**
copy的缩写,`cp 源文件 目标文件`
参数r表示复制目录,v表示显示执行的复制任务

**mv**
move的缩写,用于移动文件:`mv 源文件 目标文件目录`
也可以指定目标文件,即表示移动源文件,并更新文件名为目标文件名
所以mv也可以用于重命名.

**rm**
remove的缩写,用于删除文件:`rm 指定文件`
参数r表示删除指定文件目录
参数i表示交互式删除文件
参数f表示强制删除(会掩盖i参数)

**mkdir**
创建一个目录

**redir**
删除一个目录,不能删除非空目录,如果要删除非空目录,可以使用`rm -r`

**pwd**
用于显示当前执行的目录文件,print work directionry



# 系统目录

-bin : 可执行缩写，所有敲的命令，都是在bin中。
-boot : 引导目录，操作系统引导启动都在boot里面，其中有一个vmlinuz开头的无后缀的文件，操作系统第一个加载的就是这个内核文件。
-dev : device的缩写，保存计算机的所有设备，如网卡，硬盘等，每个设备都被抽象为一个文件，如cdrom光驱，sda就是硬盘等。
-etc : 几乎所有相关的配置文件，基本上是纯文本，以及以.conf结尾的文件
-home : 每个用户都有自己的文件夹，每个用户都在home存在与自己同名的文件夹，比如我的是qxg，所以home里面有个qxg文件夹，保存自己的私有文件或文档。
-lib : 所有相关的库文件，基以so结尾
-media : 插入优盘等会挂载里面
-mnt : 同上，但是mnt一定有，media不一定有
-opt : 通常用来装大型软件，但不是强制的
-proc : 不存在硬盘上，虚拟文件夹，存在内存中，显示系统实时信息。数字命名的文件夹，每个进程对应一个文件夹。
-sbin : super bin，只有root用户才能执行的命令
-sys : 包含底层硬件信息
-tmp: 临时目录，会自动删除。
-usr : 保存装的应用软件，软件默认装在usr里面
-var : 保存经常变化的东西，比如log,log需要经常往里写。

# 系统常用命令

时间命令：
**date**:查看系统时间，格式化方式：+%Y--%m--%d,即：`date +%Y--%m--%d`.设置当前时间可以通过date -s命令，如：date -s "20:20:20",注意是修改时间，不是年月份。
**hwclock（或clock）**:查看硬件时钟时间
**cal**:查看日历
**uptime**:查看系统运行的时间

输入查看命令：
**echo**:显示输入的内容，可以通过echo sth >> file，这样可以将sth内容输入到对应的file中
**cat**:查看一个纯文本内容
**less**:查看文件文本，空格翻页，上下键回退翻页
**more**:查看文件文本，只能向下翻页
**head**:仅显示前十行文本，-n 可以指定显示几行
**tail**:显示末尾10行，-n指定显示几行，-f可显示实时的更新内容。


查看硬件信息：
**lspci**:查看PCI设备，-v查看详细信息
**lsusb**:查看USB设备,-v查看详细信息
**lsmod**:查看设备驱动

关机重启：
**shutdown**: -h关闭计算机 -r重新启动，如立即关机：`shutdown -h now`,10分钟后关机:`shutdown -h +10`,23:30分关机:`shutdown -h 23:30`.而将-h换成-r就是重启。
为了方便关机重启，还有`reboot`,`poweroff`等命令，表示立即关机或重启。


归档，压缩：
**zip**:压缩文件，如：`zip test.zip myfile`将myfile压缩到test.zip中。
**unzip**:解压文件，如：`unzip test.zip`
**gzip**:压缩文件，更多的情况使用tar命令
**tar**:归档命令，并不是所谓压缩，比如归档：`tar -cvf out.tar myfile`将myfile归档，也可归档文件夹，不会对文件进行压缩。而打开一个归档，通过`-xvf`。
如果要压缩，可以通过-z参数，即先把归档的文件归档后，再进行压缩生成.gz文件。所以好多的压缩文件都是.tar.gz
命令如下：`tar -cvzf test.tar.gz /myDir`。-cvzf最常用


查找：
**locate**:用来快速查找文件，文件夹，类似window中的索引文件，只是查找索引,而如果要查找新建的文件，是不可能找到的，因为索引的数据库并没有更新，可以通过updatedb命令，来更新索引数据库。
**find**:老牌查找，可以定义规则进行查找，语法：find 查找位置 查找参数，但是其查找速度比较慢。
比如：`find . -name *linux*`意思为在当前目录查找所有包含linux为名字的文件
`find / -name *.conf`,查找所有文件，名字是.conf结尾的文件
`find / -perm 777`,查找权限为777的文件
`find / -type d`,查找类型为目录的文件
`find . -name "a*" -exec ls -l {} \`，查找文件以a开头的文件，-exec表示执行命令，就是查找到的文件作为参数发送给-exec后面跟随的命令 {}\是固定结尾。

# 磁盘相关
柱面：盘片中有一圈圈的轨道，比如有5个盘片，那么5个盘片相同的轨道，就是一个柱面，类似垂直的一个柱子。
扇区：由中心到边缘的一个扇子形状区域
磁头：读取数据的零件
为什么要以柱面为单位，因为磁头在读取的时候，是要转圈。

磁盘在Linux中系统的表示。

Linux中所有的设备都被抽象为文件，保存在/dev目录下。
一般命如有:hd[a-z]或sd[a-z],根据不同的接口进行命名，其中a标识第一块硬盘，b标识第二块硬盘。
比如SATA接口的命名就是sda,sdb等，一般现代计算机基本上都是sd,比如sda,sdb,sdc等。

一般分区分为MBR,GPT。
MBR一般应用于绝大多数使用BIOS的PC设备。
GPT一般应用于使用EFI的PC设备。
EFI是要取代BIOS的，但是现代计算机，基本上都会支持EFI和BIOS。


MBR不支持2T硬盘，并且最多支持4个主分区。如果要再创建分区，就需要逻辑分区。
GPT支持超过2T的硬盘，向后兼容MBR，但是必须在支持EFI(UEFI)的硬件上才能使用，必须使用64位系统。

# 用户
用户用来限制使用者对资源的使用。

* 每个用户都有一个UserID(uid)，操作系统实际使用的是用户ID标识用户,而非用户名。
* 每个用户属于一个主组，属于一个或多个附属组
* 每个组拥有一个GroupID(gid)
* 每个进程以一个用户身份运行，并受该用户可访问的资源限制。
* 每个可登录的用户，拥有一个制定的shell。

用户ID为32位，虽然是32位，但因为老系统16位，所以ID限制在6W以下。

用户又分为：root用户(ID为0)，系统用户(1-499),普通用户(500以上)。

系统用户一般是为一些服务或者程序进行创建，不需要登录等。
使用**id**可以显示当前用户的信息。使用**passwd**可以修改用户密码。

相关文件：
/etc/passwd : 保存用户信息
/etc/shadow : 保存用户密码(加密的)
/etc/group : 保存组信息

**whoami**：显示当前用户
**who**:显示登录用户
**w**:显示用户并显示在干什么

创建一个用户：
**useradd**，后跟一个用户名即可。
这个命令背后执行很多操作：在/etc/passwd中添加用户信息，如果创建密码，则在/etc/shadow添加密码数据，然后为用户创建一个新的home目录，在/home下。将/etc/skel中的文件复制到/home/下的新用户目录中，如果想要创建用户的时候，自动分配一些文件，就可以把这个文件放到/etc/skel中。接着建立同名组。
参数:-d 指定家目录， -s登录shell, -u 制定用户id，-g制定组，-G附属组。

**usermod**:对已创建的用户进行修改
-I 新用户名
-u 新用户id
-d 用户家目录位置
-g 用户所属组
-G 附属组
-L 锁定用户使其不能登录
-U 解除锁定

**userdel**：用来删除制定用户
没有参数时，只是删除用户，但是不删除家目录，而加上-r参数才会删除家目录。
# 权限
每个文件拥有三种权限

|权限|对文件的影响|对目录的影响|

|--|--|--|
|r(读取)|可读取文件内容|可列出目录内容|
|w(写入)|可修改文件内容|可在目录中创建删除文件|
|x(执行)|可作为命令执行|可访问目录内容|

目录必须拥有x权限，否则无法查看其内容。

Linux权限都是基于UGO进行设计，U是user,G是group，O是other，并且权限三个一组(rwx)，所以一般对于一个文件的权限是9个字符,但是开头还有额外的一个字符d,表示文件类型，d是dir即文件夹。


**chown**修改文件的所属用户，**chgrp**修改文件所属组

**chmod**修改文件权限，其首先指ugo,然后通过+,-号来增加或删除权限，如：
chmod u+rw myfile //将myfile添加user的rw权限
chmod g-x myfile //将myfile的g的权限的x删去
如果要对目录下所有文件都修改权限，则需要加入参数-R。

还可以用数字修改权限，比如r=4，w=2,x=1,rw = 4+2 =6 ,rwx = 4+2+1=7, r-x = 4+1=5
所以chmod 777 myfile,后myfile的权限为-rwxrwxrwx权限。


# 服务器相关

最近买了一个Ubuntu的服务器，发现没有图形界面，只能敲命令。
从本机连接到服务器的方式是：ssh name@ip  比如我的是ssh ubuntu@118.89.*.**，之后输入密码即可

而如果要装tomcat就必须有tar.gz文件，也就是说从本机传送文件过去，传送方法是：scp:
scp root@192.168.1.155:1.txt 2.txt （把服务器的1.txt下载到本地，并且重命名为2.txt）
scp 2.txt root@192.168.1.155:3.txt （把本地2.txt文件上传到服务器的root目录下，并且命名为3.txt）

如果要传送文件夹，加上参数-r即可

**安装myql**:`sudo apt install mysql-server`

**Tomcat配置**:http://jingyan.baidu.com/article/e4d08ffdabb0710fd2f60de9.html

**JDK配置**:http://blog.csdn.net/w965440884/article/details/51498556

**Tomcat部署项目**:部署方法很简单,就是把对应的项目目录发送到服务器的tomcat的webapps目录下即可.
# VIM相关

首先vim的ctrl + s是锁定屏幕而不是保存，需要使用ctrl+q解锁

然后如果要进入插入模式，需要按i键，或者直接打字等。

要退出编辑模式，需要先按照ESC键

保存退出命令是`:wq`或`:w`第一个是保存并退出，第二个是仅保存

Vim拥有三种模式，命令模式，插入模式，ex模式。

命令模式，可以通过命令完成选择复制粘贴等功能。命令模式下，按很多键都不会有响应。
而如果要输入内容，在命令模式中按i键，就进入插入模式。
命令模式下按:，就会进入ex模式，该模式可以保存修改，或者退出。

命令模式：
i 在当前光标前插入文本
o 在当前行下插入新行
dd 删除整行
yy 将当前行的内容放入缓冲区(复制当前行)
n+yy 将n行的内容放入缓冲区(光标下的n行)
p 将缓冲区的内容移出放入光标后
u 撤销上一个操作
r 替换当前字符
/ 查找关键字，查找到后，按n键，就可以在查找的内容间进行切换。

ex模式：
:w 保存当前修改
:q 退出
:q! 强制退出，不保存修改
:x 保存并退出，和:wq一样。
:set nu 显示行号
:! 系统命令 =>执行系统命令，并显示结果，如`:! ls`
:sh 切换到命令行，使用ctrl+d切换到vim

# 网络 
IPv4 32位,IPv6 128位

ifconfig 是 interface config的缩写.
查询网络接口信息.

测试网络连通性:
`ping www.baidu.com`

测试DNS解析:
host www.baidu.com
dig www.baidu.com
dig比较专业

显示路由表
ip route

追踪到达目标地址的网络路径
traceroute www.baidu.com

使用mtr进行网络质量测试
mtr www.baidu.com

修改主机名
hostname 查看主机名
hostname qxg 修改主机名为qxg,但是重启后就没有了.
如果要永久修改,需要修改文件

故障排查
遵循**从底层到高层,从自身到外部**
首先查看网络配置信息是否正确:ip,子网,网关,DNS
再看网关是否联通:ping ...
查看DNS是否解析正常:host www.xxx.com


# 复杂命令

|关键字|定义|例子|
|-----|---|--|
|>|将STDOUT重定向到文件(覆盖)|echo "something" > outfile.txt|
|>>|将STDOUT重定向到文件(追加)|echo "something" >> outfile.txt|
|2>|将STDERR重定向的文件(覆盖),当出现错误的时候会显示在屏幕|echo "err" 2> errfile.txt|
|2>&1|将STDERR和STDOUT结合,输出和出错信息都会重定向|ls sth 2>&1 outfile|
|<|重定向STDIN |grep sth < /etc/file|
|||将一个命令的输出作为另一个命令的输入|ls -l | grep sth|

# 命令行文本处理
cat,more,less,head,tail等可在上边查看.

* grep
基于关键字进行搜索,如grep 'sth' /etc/afile,表示在afile中搜索包含'sth'关键字的一行.
-i 忽略大小写
-n 显示结果所在行
-v 输出不带关键字的行
-Ax 在输出的时候包含结果所在行之后的指定x行数(After x)
-Bx 在输出的时候包含结果所在行之前的指定x行数(Before x)

* cut 用于基于列处理文本内容
-d 指定分割符
-f 指定输出的列号
-c 基于字符进行切割 cut -c2-6 /etc/passwd 只显示第2到第6个字符
如: cut -d: -f1 /etc/passwd 使用":"作为分隔符切割成一列一列的信息,之后显示第一列.

* wc 统计文本信息 word count
-l 只统计行数
-w 只统计单词数
-c 统计字节数
-m 统计字符数

* sort 对文本进行排序,只支持英文和数字
-r 倒序
-n 数字排序
-f 忽略大小写
-u 删除重复行

* diff 文本比较
-i 忽略大小写
-b 忽略空格数量的变化
-u 统一显示比较信息

# Linux系统启动


